local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer

for _, v in pairs(CoreGui:GetChildren()) do
	if v.Name == "EightCI_Window" then
		v:Destroy()
	end
end

local EightCI = {}

function EightCI:CreateWindow(cfg)
	local Gui = Instance.new("ScreenGui")
	Gui.Name = "EightCI_Window"
	Gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	Gui.Parent = CoreGui

	local Main = Instance.new("Frame")
	Main.Name = "Main"
	Main.Size = UDim2.new(0, 290, 0, 214)
	Main.Position = UDim2.new(0, 230, 0, 32)
	Main.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	Main.BorderSizePixel = 0
	Main.Active = true
	Main.Draggable = true
	Main.Parent = Gui
	Instance.new("UICorner", Main)

	local TitleFrame = Instance.new("Frame")
	TitleFrame.Size = UDim2.new(0, 228, 0, 24)
	TitleFrame.Position = UDim2.new(0, 16, 0, 6)
	TitleFrame.BackgroundTransparency = 1
	TitleFrame.Parent = Main

	local TitleText = Instance.new("TextLabel")
	TitleText.Text = cfg.Title or "EightCI Ui"
	TitleText.Size = UDim2.new(0, 228, 0, 24)
	TitleText.BackgroundTransparency = 1
	TitleText.TextColor3 = Color3.fromRGB(255, 255, 255)
	TitleText.TextScaled = true
	TitleText.TextXAlignment = Enum.TextXAlignment.Left
	TitleText.Parent = TitleFrame

	local Close = Instance.new("TextButton")
	Close.Text = "-"
	Close.Size = UDim2.new(0, 36, 0, 26)
	Close.Position = UDim2.new(0, 248, 0, 4)
	Close.BackgroundTransparency = 1
	Close.TextScaled = true
	Close.TextColor3 = Color3.fromRGB(255, 255, 255)
	Close.Parent = Main

	local Scroll = Instance.new("ScrollingFrame")
	Scroll.Size = UDim2.new(0, 284, 0, 173)
	Scroll.Position = UDim2.new(0, 3, 0, 37)
	Scroll.BackgroundTransparency = 1
	Scroll.ScrollBarThickness = 3
	Scroll.ElasticBehavior = Enum.ElasticBehavior.Never
	Scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
	Scroll.Parent = Main

	local Layout = Instance.new("UIListLayout")
    Layout.Padding = UDim.new(0, 8)
    Layout.SortOrder = Enum.SortOrder.LayoutOrder
    Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    Layout.Parent = Scroll

	Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		Scroll.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y + 10)
	end)

	local Window = {}

	function Window:OpenButton(data)
		local OpenButton = Instance.new("Frame")
		OpenButton.Name = "OpenButton"
		OpenButton.Size = UDim2.new(0, 132, 0, 44)
		OpenButton.Position = UDim2.new(0, 32, 0, 14)
		OpenButton.BackgroundColor3 = Color3.fromRGB(6, 6, 6)
		OpenButton.Visible = false
		OpenButton.Active = true
	    OpenButton.Draggable = true
		OpenButton.Parent = Gui

		local corner = Instance.new("UICorner")
		corner.CornerRadius = data.CornerRadius or UDim.new(0, 20)
		corner.Parent = OpenButton

		local OpenText = Instance.new("TextButton")
		OpenText.Text = data.Title or "Open"
		OpenText.Size = UDim2.new(0, 82, 0, 32)
		OpenText.Position = UDim2.new(0, 43, 0, 6)
		OpenText.BackgroundTransparency = 1
		OpenText.TextColor3 = Color3.fromRGB(255, 255, 255)
		OpenText.TextScaled = true
		OpenText.Parent = OpenButton

		local OpenIcon = Instance.new("ImageLabel")
		OpenIcon.Image = data.Icon or "rbxassetid://844956"
		OpenIcon.Size = UDim2.new(0, 31, 0, 31)
		OpenIcon.Position = UDim2.new(0, 6, 0, 7)
		OpenIcon.BackgroundTransparency = 1
		OpenIcon.Parent = OpenButton

		Close.MouseButton1Click:Connect(function()
			Main.Visible = false
			OpenButton.Visible = true
		end)

		OpenText.MouseButton1Click:Connect(function()
			Main.Visible = true
			OpenButton.Visible = false
		end)
	end

	function Window:Button(data)
		local Button = Instance.new("TextButton")
		Button.Size = UDim2.new(0, 252, 0, 36)
		Button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		Button.BorderSizePixel = 0
		Button.Text = ""
		Button.Parent = Scroll
		Instance.new("UICorner", Button)

		local Title = Instance.new("TextLabel")
		Title.Text = data.Title or "Button"
		Title.Size = UDim2.new(0, 192, 0, 26)
		Title.Position = UDim2.new(0, 10, 0, 5)
		Title.BackgroundTransparency = 1
		Title.TextColor3 = Color3.fromRGB(255, 255, 255)
		Title.TextScaled = true
		Title.TextXAlignment = Enum.TextXAlignment.Left
		Title.Parent = Button

		Button.MouseButton1Click:Connect(function()
			pcall(data.Callback)
		end)
	end

	function Window:Toggle(data)
		local Toggle = Instance.new("TextButton")
		Toggle.Size = UDim2.new(0, 252, 0, 36)
		Toggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		Toggle.BorderSizePixel = 0
		Toggle.Text = ""
		Toggle.Parent = Scroll
		Instance.new("UICorner", Toggle)

		local TTitle = Instance.new("TextLabel")
		TTitle.Text = data.Title or "Toggle"
		TTitle.Size = UDim2.new(0, 192, 0, 26)
		TTitle.Position = UDim2.new(0, 10, 0, 5)
		TTitle.BackgroundTransparency = 1
		TTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
		TTitle.TextScaled = true
		TTitle.TextXAlignment = Enum.TextXAlignment.Left
		TTitle.Parent = Toggle

		local CheckBox = Instance.new("Frame")
		CheckBox.Size = UDim2.new(0, 26, 0, 26)
		CheckBox.Position = UDim2.new(0, 215, 0, 5)
		CheckBox.BackgroundColor3 = data.Default and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(114, 114, 114)
		CheckBox.BorderSizePixel = 0
		CheckBox.Parent = Toggle
		local c = Instance.new("UICorner")
		c.CornerRadius = UDim.new(0, 4)
		c.Parent = CheckBox

		local state = data.Default or false
		Toggle.MouseButton1Click:Connect(function()
			state = not state
			CheckBox.BackgroundColor3 = state and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(114, 114, 114)
			pcall(data.Callback, state)
		end)
	end

	function Window:TextBox(data)
		local BoxFrame = Instance.new("Frame")
		BoxFrame.Size = UDim2.new(0, 252, 0, 36)
		BoxFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		BoxFrame.BorderSizePixel = 0
		BoxFrame.Parent = Scroll
		Instance.new("UICorner", BoxFrame)

		local BoxTitle = Instance.new("TextLabel")
		BoxTitle.Text = data.Title or "TextBox"
		BoxTitle.Size = UDim2.new(0, 138, 0, 26)
		BoxTitle.Position = UDim2.new(0, 10, 0, 5)
		BoxTitle.BackgroundTransparency = 1
		BoxTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
		BoxTitle.TextScaled = true
		BoxTitle.TextXAlignment = Enum.TextXAlignment.Left
		BoxTitle.Parent = BoxFrame

		local TextBox = Instance.new("TextBox")
		TextBox.Size = UDim2.new(0, 88, 0, 28)
		TextBox.Position = UDim2.new(0, 156, 0, 4)
		TextBox.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
		TextBox.TextColor3 = Color3.fromRGB(242, 242, 242)
		TextBox.TextScaled = true
		TextBox.PlaceholderText = data.Placeholder or "Enter Text..."
		TextBox.Text = ""
		TextBox.Parent = BoxFrame
		local cc = Instance.new("UICorner")
		cc.CornerRadius = UDim.new(0, 4)
		cc.Parent = TextBox

		TextBox.FocusLost:Connect(function(enter)
			if enter then
				pcall(data.Callback, TextBox.Text)
			end
		end)
	end

	return Window
end

return EightCI
