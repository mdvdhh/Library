local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local EightCI = {}
local UI = {}

local oldGui = CoreGui:FindFirstChild("EightCI_Window")
if oldGui then oldGui:Destroy() end

local function Tween(obj, props, time, style)
	style = style or Enum.EasingStyle.Quad
	local tween = TweenService:Create(obj, TweenInfo.new(time or 0.2, style, Enum.EasingDirection.Out), props)
	tween:Play()
	return tween
end

function EightCI:CreateWindow(config)
	if UI.Window then UI.Window:Destroy() end

	local Window = Instance.new("ScreenGui")
	Window.Name = "EightCI_Window"
	Window.IgnoreGuiInset = true
	Window.Parent = CoreGui

	local Main = Instance.new("Frame")
	Main.Name = "Main"
	Main.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
	Main.BorderSizePixel = 0
	Main.Position = UDim2.new(0.5, -107, 0.5, -146)
	Main.Size = UDim2.new(0, 214, 0, 292)
	Main.Active = true
	Main.Draggable = true
	Main.Parent = Window

	local MainCorner = Instance.new("UICorner")
	MainCorner.CornerRadius = UDim.new(0, 8)
	MainCorner.Parent = Main

	local Title = Instance.new("TextLabel")
	Title.BackgroundTransparency = 1
	Title.Size = UDim2.new(1, 0, 0, 34)
	Title.Text = config.Title or "EightCI Ui"
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.TextSize = 18
	Title.Font = Enum.Font.GothamBold
	Title.Parent = Main

	local Scroll = Instance.new("ScrollingFrame")
	Scroll.BackgroundTransparency = 1
	Scroll.BorderSizePixel = 0
	Scroll.Position = UDim2.new(0, 0, 0, 40)
	Scroll.Size = UDim2.new(1, 0, 1, -40)
	Scroll.ScrollBarThickness = 3
	Scroll.Parent = Main

	local ListLayout = Instance.new("UIListLayout")
	ListLayout.Padding = UDim.new(0, 8)
	ListLayout.Parent = Scroll

	local Padding = Instance.new("UIPadding")
	Padding.PaddingTop = UDim.new(0, 6)
	Padding.PaddingLeft = UDim.new(0, 8)
	Padding.PaddingRight = UDim.new(0, 8)
	Padding.Parent = Scroll

	UI.Window = Window
	UI.Scroll = Scroll
end

function EightCI:Button(config)
	local btn = Instance.new("TextButton")
	btn.Name = config.Title or "Button"
	btn.Size = UDim2.new(1, -16, 0, 32)
	btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	btn.BorderSizePixel = 0
	btn.Text = config.Title or "Button"
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.TextSize = 12
	btn.Font = Enum.Font.Gotham
	btn.AutoButtonColor = false
	btn.Parent = UI.Scroll

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 6)
	corner.Parent = btn

	btn.MouseEnter:Connect(function()
		Tween(btn, {BackgroundColor3 = Color3.fromRGB(0, 120, 255)}, 0.2)
	end)
	btn.MouseLeave:Connect(function()
		Tween(btn, {BackgroundColor3 = Color3.fromRGB(40, 40, 40)}, 0.2)
	end)
	btn.MouseButton1Click:Connect(function()
		Tween(btn, {BackgroundColor3 = Color3.fromRGB(0, 255, 255)}, 0.1)
		task.wait(0.1)
		Tween(btn, {BackgroundColor3 = Color3.fromRGB(0, 120, 255)}, 0.2)
		pcall(config.Callback)
	end)
end

function EightCI:Toggle(config)
	local container = Instance.new("Frame")
	container.Name = config.Title or "Toggle"
	container.Size = UDim2.new(1, -16, 0, 32)
	container.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	container.BorderSizePixel = 0
	container.Parent = UI.Scroll

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 6)
	corner.Parent = container

	local title = Instance.new("TextLabel")
	title.BackgroundTransparency = 1
	title.Size = UDim2.new(0.75, 0, 1, 0)
	title.Position = UDim2.new(0.05, 0, 0, 0)
	title.Text = config.Title or "Toggle"
	title.TextColor3 = Color3.fromRGB(255, 255, 255)
	title.Font = Enum.Font.Gotham
	title.TextSize = 12
	title.TextXAlignment = Enum.TextXAlignment.Left
	title.Parent = container

	local switch = Instance.new("Frame")
	switch.Size = UDim2.new(0, 40, 0, 20)
	switch.Position = UDim2.new(1, -48, 0.5, -10)
	switch.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
	switch.Parent = container

	local switchCorner = Instance.new("UICorner")
	switchCorner.CornerRadius = UDim.new(1, 0)
	switchCorner.Parent = switch

	local knob = Instance.new("Frame")
	knob.Size = UDim2.new(0, 16, 0, 16)
	knob.Position = UDim2.new(0, 2, 0.5, -8)
	knob.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
	knob.Parent = switch

	local knobCorner = Instance.new("UICorner")
	knobCorner.CornerRadius = UDim.new(1, 0)
	knobCorner.Parent = knob

	local enabled = config.Default or false

	local function Update()
		if enabled then
			Tween(switch, {BackgroundColor3 = Color3.fromRGB(0, 170, 255)}, 0.2)
			Tween(knob, {Position = UDim2.new(1, -18, 0.5, -8), BackgroundColor3 = Color3.fromRGB(255, 255, 255)}, 0.2)
			local glow = Instance.new("UIStroke")
			glow.Thickness = 2
			glow.Color = Color3.fromRGB(0, 200, 255)
			glow.Parent = knob
			task.delay(0.3, function()
				if glow then glow:Destroy() end
			end)
		else
			Tween(switch, {BackgroundColor3 = Color3.fromRGB(90, 90, 90)}, 0.2)
			Tween(knob, {Position = UDim2.new(0, 2, 0.5, -8), BackgroundColor3 = Color3.fromRGB(200, 200, 200)}, 0.2)
		end
		pcall(config.Callback, enabled)
	end

	container.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			enabled = not enabled
			Update()
		end
	end)

	container.MouseEnter:Connect(function()
		Tween(container, {BackgroundColor3 = Color3.fromRGB(130, 130, 130)}, 0.2)
	end)
	container.MouseLeave:Connect(function()
		Tween(container, {BackgroundColor3 = Color3.fromRGB(255, 255, 255)}, 0.2)
	end)

	Update()
end

return EightCI
